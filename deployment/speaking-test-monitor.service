[Unit]
Description=Speaking Test Booking System Monitor
After=network.target
Wants=network.target

[Service]
Type=simple
User=deploy
Group=deploy
WorkingDirectory=/var/www/speaking-test-booking
ExecStart=/usr/bin/node /var/www/speaking-test-booking/deployment/monitoring.js
Restart=always
RestartSec=10
StandardOutput=append:/var/log/speaking-test-booking/monitor.log
StandardError=append:/var/log/speaking-test-booking/monitor-error.log

# Environment variables
Environment=NODE_ENV=production
Environment=HEALTH_CHECK_URL=http://localhost:3001/health
Environment=CHECK_INTERVAL=30000
Environment=MONITOR_LOG_FILE=/var/log/speaking-test-booking/monitor.log

# Security settings
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/var/log/speaking-test-booking
ReadWritePaths=/var/www/speaking-test-booking

# Resource limits
LimitNOFILE=65536
LimitNPROC=4096

[Install]
WantedBy=multi-user.target